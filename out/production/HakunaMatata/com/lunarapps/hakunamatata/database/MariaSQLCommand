--default DB engine is InnoDB...no need to say ENGINE=InnoDB

CREATE TABLE USER IF NOT EXISTS(
    USER_ID INT UNSIGNED AUTO INCREMENT,
    FIRST_NAME VARCHAR(30) NOT NULL,
    LAST_NAME VARCHAR(30) NOT NULL,
    SEX ENUM('MALE','FEMALE') NOT NULL,
    EMAIL EMAIL NULL,
    USERNAME VARCHAR(40) NOT NULL,
    PASSWORD VARCHAR(40) NOT NULL,
    PRIMARY KEY(USERNAME)
) DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;

CREATE TABLE STORED IF NOT EXISTS(
    DOC_ID INT UNSIGNED AUTO INCREMENT,
    DOC_NAME VARCHAR(120) NOT NULL,
    UPLOADER VARCHAR(30) NOT NULL,
    ACCESSIBILITY ENUM('PRIVATE', 'PUBLIC'),
    DOWNLOAD_COUNT INT UNSIGNED DEFAULT 0,
    TYPE ENUM('IMAGE', 'PDF') NOT NULL,
    PATH VARCHAR(255) NOT NULL,
    UNIQUE(DOC_NAME, UPLOADER, TYPE),
    PRIMARY KEY(DOC_ID),
    FOREIGN KEY STORED(UPLOADER) REFERENCES USER(USERNAME)
    ON UPDATE CASCADE ON DELETE SET NULL
)DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;


CREATE TABLE SHARED(
    SHARED_ID INT UNSIGNED AUTO_INCREMENT,
    SHARED_NAME VARCHAR(120) NOT NULL,
    FIRST_UPLOADER VARCHAR(30) NOT NULL,
    SHARED_TO VARCHAR(30) NOT NULL,
    SHARED_TYPE ENUM('IMAGE', 'PDF') NOT NULL,
    SHARED_PATH VARCHAR(255) NOT NULL,
    FOREIGN KEY(SHARED_NAME) REFERENCES STORED(DOC_NAME) ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY(FIRST_UPLOADER) REFERENCES USER(USERNAME) ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY(SHARED_TO) REFERENCES USER(USERNAME) ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY(SHRED_PATH) REFERENCES STORED(PATH) ON DELETE CASCADE ON UPDATE CASCADE
    FOREIGN KEY(SHARED_TYPE) REFERENCES STORED(TYPE) ON DELETE CASCADE ON UPDATE CASCADE
)DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;

CREATE TABLE FEEDBACK IF NOT EXISTS(
    FEED_ID INT UNSIGNED AUTO INCREMENT PRIMARY KEY,
    COMMENTER VARCHAR(30) NOT NULL,
    FEED_BACK VARCHAR(1000) NOT NULL,
    FEED_DATE DATE NOT NULL,
    FOREIGN KEY(COMMENTER) REFERENCES USER(USERNAME)
    ON DELETE SET NULL ON UPDATE CASCADE
)DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;

CREATE TABLE SEARCH_HISTORY IF NOT EXISTS(
    HIST_ID INT AUTO INCREMENT,
    SEARCHER VARCHAR(30) NOT NULL,
    SEARCH VARCHAR(255) NOT NULL,
    SEARCH_DATE DATE NOT NULL,
    FOREIGN KEY(SEARCHER) REFERENCES USER(USERNAME) ON DELETE SET NULL ON UPDATE CASCADE,
    PRIMARY KEY(HIST_ID, SEARCHER, SEARCH, SEARCH_DATE)
)DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;


--and more tables

